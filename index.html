<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Survey-Weighted Function on Scalar Regression • svyfosr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Survey-Weighted Function on Scalar Regression">
<meta name="description" content="Uses the fast univariate inference (FUI) framework to implement (complex) survey-weighted function on scalar regression. It also provides tools for visualizing and interpreting the results of these models. The FUI framework is based on the idea of fitting a series of univariate models to the data, which can be done quickly and efficiently. This approach allows for the incorporation of survey weights and design effects into the analysis, making it suitable for complex survey data. The package includes functions for fitting the models, as well as functions for visualizing the results and assessing model fit. Overall, this package provides a powerful tool for analyzing complex survey data using function on scalar regression models.">
<meta property="og:description" content="Uses the fast univariate inference (FUI) framework to implement (complex) survey-weighted function on scalar regression. It also provides tools for visualizing and interpreting the results of these models. The FUI framework is based on the idea of fitting a series of univariate models to the data, which can be done quickly and efficiently. This approach allows for the incorporation of survey weights and design effects into the analysis, making it suitable for complex survey data. The package includes functions for fitting the models, as well as functions for visualizing the results and assessing model fit. Overall, this package provides a powerful tool for analyzing complex survey data using function on scalar regression models.">
<meta property="og:image" content="https://jhuwit.github.io/svyfosr/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">svyfosr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="svyfosr">
<code>svyfosr</code><a class="anchor" aria-label="anchor" href="#svyfosr"></a>
</h1>
</div>
</div>
<div class="section level1">
<h1 id="svyfosr-">svyfosr <a class="anchor" aria-label="anchor" href="#svyfosr-"></a>
</h1>
<!-- badges: start -->

<p>The goal of <code>svyfosr</code> is to perform survey-weighted function on scalar regression (FoSR).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>svyfosr</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"jhuwit/svyfosr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We load some simulated survey data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhuwit.github.io/svyfosr/">svyfosr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample_df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 975</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; $ id       &lt;int&gt; 1421, 1692, 2156, 2841, 3174, 5296, 6796, 7669, 7780, 9758, 1…</span></span>
<span><span class="co">#&gt; $ X        &lt;dbl&gt; 2.00743154, -1.51583313, 0.06838228, -3.68259165, -2.57527700…</span></span>
<span><span class="co">#&gt; $ strata   &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ psu      &lt;chr&gt; "70", "70", "70", "70", "70", "70", "70", "70", "70", "70", "…</span></span>
<span><span class="co">#&gt; $ weight   &lt;dbl&gt; 76.42787, 82.65374, 82.05325, 91.31247, 86.76654, 85.77362, 8…</span></span>
<span><span class="co">#&gt; $ p_stage1 &lt;dbl&gt; 0.02137936, 0.02137936, 0.02137936, 0.02137936, 0.02137936, 0…</span></span>
<span><span class="co">#&gt; $ p_stage2 &lt;dbl&gt; 0.6120031, 0.5659041, 0.5700456, 0.5122421, 0.5390799, 0.5453…</span></span>
<span><span class="co">#&gt; $ Y        &lt;dbl[,50]&gt; &lt;matrix[26 x 50]&gt;</span></span>
<span></span>
<span><span class="va">Y_df</span> <span class="op">=</span> <span class="va">sample_df</span><span class="op">$</span><span class="va">Y</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*Y"</span>, <span class="st">""</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y_df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">l</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/subtheme.html" class="external-link">theme_sub_axis</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                 title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Functional Domain"</span>, y <span class="op">=</span> <span class="st">"Y"</span>, title <span class="op">=</span> <span class="st">"Smoothed Outcomes for 10 Random Subjects"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<p>We fit a survey-weighted FoSR model using balanced repeated replication (BRR) to estimate standard errors.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">model_fit</span> <span class="op">=</span> <span class="fu">svyfosr</span><span class="fu">::</span><span class="fu"><a href="reference/svyfui.html">svyfui</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">sample_df</span>, </span>
<span>                            weights <span class="op">=</span> <span class="va">weight</span>,</span>
<span>                            family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                            boot_type <span class="op">=</span> <span class="st">"BRR"</span>,</span>
<span>                            num_boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                            parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                            seed <span class="op">=</span> <span class="fl">2213</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimating coefficients</span></span>
<span><span class="co">#&gt; Smoothing coefficients</span></span>
<span><span class="co">#&gt; Bootstrapping</span></span>
<span><span class="co">#&gt; Obtaining pointwise and joint confidence intervals</span></span>
<span><span class="co">#&gt; Completed!</span></span>
<span></span>
<span><span class="va">model_fit</span></span>
<span><span class="co">#&gt; Survey FUI object</span></span>
<span><span class="co">#&gt; -----------------</span></span>
<span><span class="co">#&gt; Number of bootstrap replicates: 100 </span></span>
<span><span class="co">#&gt; # A tibble: 100 × 7</span></span>
<span><span class="co">#&gt;        l beta_hat lower_pw upper_pw lower_joint upper_joint var_name   </span></span>
<span><span class="co">#&gt;    &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;      </span></span>
<span><span class="co">#&gt;  1     1   -0.179   -0.240   -0.118      -0.258      -0.101 (Intercept)</span></span>
<span><span class="co">#&gt;  2     2   -0.191   -0.245   -0.138      -0.260      -0.122 (Intercept)</span></span>
<span><span class="co">#&gt;  3     3   -0.203   -0.252   -0.154      -0.266      -0.140 (Intercept)</span></span>
<span><span class="co">#&gt;  4     4   -0.214   -0.263   -0.166      -0.276      -0.152 (Intercept)</span></span>
<span><span class="co">#&gt;  5     5   -0.224   -0.275   -0.173      -0.289      -0.159 (Intercept)</span></span>
<span><span class="co">#&gt;  6     6   -0.231   -0.286   -0.177      -0.302      -0.161 (Intercept)</span></span>
<span><span class="co">#&gt;  7     7   -0.237   -0.296   -0.177      -0.313      -0.160 (Intercept)</span></span>
<span><span class="co">#&gt;  8     8   -0.240   -0.304   -0.176      -0.323      -0.158 (Intercept)</span></span>
<span><span class="co">#&gt;  9     9   -0.242   -0.310   -0.174      -0.330      -0.154 (Intercept)</span></span>
<span><span class="co">#&gt; 10    10   -0.242   -0.314   -0.170      -0.334      -0.149 (Intercept)</span></span>
<span><span class="co">#&gt; # ℹ 90 more rows</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing svyfosr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lily Koffman <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1543-2896" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>John Muschelli <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-6469-1750" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jhuwit/svyfosr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/jhuwit/svyfosr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/jhuwit/svyfosr" class="external-link"><img src="https://codecov.io/gh/jhuwit/svyfosr/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lily Koffman, John Muschelli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
